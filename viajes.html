<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nuestros Viajes</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">

<style>
/* ===== RESET ===== */
*{margin:0;padding:0;box-sizing:border-box;}
body{
font-family:'Playfair Display', serif;
background:linear-gradient(180deg,#0b0b10,#141420);
color:white;
overflow-x:hidden;
padding-top:100px;
}
h1{text-align:center;margin-bottom:40px;letter-spacing:4px;font-weight:400;}

/* ===== NAVBAR ===== */
nav{
position:fixed;
top:0;
width:100%;
padding:18px 30px;
display:flex;
justify-content:space-between;
align-items:center;
background:rgba(0,0,0,0.6);
backdrop-filter:blur(12px);
z-index:1000;
}

.logo{
font-size:1rem;
letter-spacing:3px;
}

/* MENU DESKTOP */
.menu{
display:flex;
align-items:center;
gap:20px;
}

.menu a{
text-decoration:none;
color:white;
font-size:0.85rem;
opacity:0.7;
transition:0.3s;
}

.menu a:hover{opacity:1;}

/* HAMBURGER */
.hamburger{
display:none;
flex-direction:column;
cursor:pointer;
gap:5px;
}

.hamburger span{
width:22px;
height:2px;
background:white;
transition:0.3s;
}

/* RESPONSIVE */
@media (max-width:768px){

.hamburger{display:flex;}

.menu{
position:absolute;
top:70px;
right:0;
width:100%;
flex-direction:column;
background:rgba(0,0,0,0.95);
backdrop-filter:blur(12px);
padding:25px 0;
gap:20px;
text-align:center;
transform:translateY(-120%);
transition:0.4s ease;
}

.menu a{
font-size:1rem;
}

.menu.active{
transform:translateY(0);
}
}

/* CONTENEDOR */
.container{max-width:1200px;margin:auto;padding:0 20px;}

/* ÁLBUMES */
.album-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:25px;margin-bottom:40px;}
.album{position:relative;height:220px;border-radius:20px;overflow:hidden;background:rgba(255,255,255,0.05);display:flex;align-items:flex-end;padding:20px;cursor:pointer;transition:0.3s;}
.album:hover{transform:scale(1.03);}
.album img{position:absolute;width:100%;height:100%;object-fit:cover;top:0;left:0;z-index:-1;}
.album::after{content:"";position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.8),transparent);}
.album-title{position:relative;font-weight:500;font-size:1rem;}
.album-actions{position:absolute;top:10px;right:10px;display:flex;gap:6px;z-index:2;}
.action-btn{background:rgba(0,0,0,0.7);border:none;color:white;font-size:11px;padding:5px 8px;border-radius:8px;cursor:pointer;}

.create-btn{display:block;margin:20px auto;padding:10px 25px;border:1px solid rgba(255,255,255,0.4);border-radius:30px;background:none;color:white;cursor:pointer;transition:0.3s;}
.create-btn:hover{background:white;color:black;}

#photoView{display:none;}
.back-btn{display:inline-block;margin-bottom:15px;cursor:pointer;}
.gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:15px;margin-top:20px;}
.photo{position:relative;border-radius:12px;overflow:hidden;}
.photo img{width:100%;height:160px;object-fit:cover;}
.delete-btn{position:absolute;top:5px;right:5px;background:rgba(0,0,0,0.7);border:none;color:white;padding:4px 6px;border-radius:6px;cursor:pointer;}
textarea{width:100%;margin-top:15px;background:rgba(255,255,255,0.05);border:none;color:white;padding:12px;border-radius:12px;min-height:80px;}

#lightbox{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,0.9);
justify-content:center;
align-items:center;
z-index:2000;
}

#lightbox img{max-width:90%;max-height:90%;border-radius:20px;}

footer{text-align:center;padding:40px 20px;font-size:0.75rem;opacity:0.4;margin-top:50px;}
</style>
</head>
<body>

<nav>
<div class="logo">NUESTROS VIAJES</div>

<div class="hamburger" id="hamburger">
<span></span>
<span></span>
<span></span>
</div>

<div class="menu" id="menu">
<a href="index.html">Inicio</a>
<a href="viajes.html">Nuestros Viajes</a>
<a href="pelicula.html">EL Momento</a>
<a href="timeline.html">TimeLine</a>
<a href="constelaciones.html">Nuestras Estrellas</a>
</div>
</nav>

<div class="container">
<h1 id="pageTitle">Álbumes</h1>

<div id="albumView">
<div class="album-grid" id="albumGrid"></div>
<button class="create-btn" onclick="createAlbum()">Crear Nuevo Álbum</button>
</div>

<div id="photoView">
<span class="back-btn" onclick="goBack()">← Volver a Álbumes</span>
<h2 id="albumName"></h2>

<label class="create-btn">
Subir Fotos
<input type="file" id="photoInput" accept="image/*" multiple hidden>
</label>

<textarea id="albumNote" placeholder="Escribe algo sobre este viaje..."></textarea>

<div class="gallery" id="gallery"></div>
</div>
</div>

<div id="lightbox"><img id="lightboxImg"></div>

<footer>Hecho con amor y viajes ✨</footer>

<script>

/* ===== MENU MOVIL ===== */
const hamburger=document.getElementById("hamburger");
const menu=document.getElementById("menu");

hamburger.addEventListener("click",()=>{
menu.classList.toggle("active");
});

document.querySelectorAll(".menu a").forEach(link=>{
link.addEventListener("click",()=>{
menu.classList.remove("active");
});
});

/* ===== ÁLBUMES ===== */
let albums = JSON.parse(localStorage.getItem("viajesAlbums")) || {
"París 2026": {photos: [], note:""},
"Japón Soñado": {photos: [], note:""},
"Roma": {photos: [], note:""}
};

let currentAlbum = null;
const albumGrid = document.getElementById("albumGrid");
const gallery = document.getElementById("gallery");
const albumView = document.getElementById("albumView");
const photoView = document.getElementById("photoView");
const pageTitle = document.getElementById("pageTitle");
const noteField = document.getElementById("albumNote");

function saveAlbums(){localStorage.setItem("viajesAlbums", JSON.stringify(albums));}

function renderAlbums(){
albumGrid.innerHTML="";
Object.keys(albums).forEach(name=>{
const div=document.createElement("div");div.className="album";

if(albums[name].photos[0]){
const img=document.createElement("img");img.src=albums[name].photos[0];div.appendChild(img);
}

const title=document.createElement("div");title.className="album-title";title.textContent=name;
const actions=document.createElement("div");actions.className="album-actions";

const edit=document.createElement("button");
edit.className="action-btn";
edit.textContent="Editar";
edit.onclick=(e)=>{
e.stopPropagation();
let newName=prompt("Nuevo nombre:",name);
if(!newName||albums[newName])return;
albums[newName]=albums[name];
delete albums[name];
saveAlbums();
renderAlbums();
};

const del=document.createElement("button");
del.className="action-btn";
del.textContent="Eliminar";
del.onclick=(e)=>{
e.stopPropagation();
if(confirm("¿Eliminar álbum?")){
delete albums[name];
saveAlbums();
renderAlbums();
}
};

actions.appendChild(edit);
actions.appendChild(del);
div.appendChild(actions);
div.appendChild(title);
div.onclick=()=>openAlbum(name);
albumGrid.appendChild(div);
});
}

function createAlbum(){
let name=prompt("Nombre del nuevo viaje:");
if(!name||albums[name])return;
albums[name]={photos:[],note:""};
saveAlbums();
renderAlbums();
}

function openAlbum(name){
currentAlbum=name;
pageTitle.textContent=name;
albumView.style.display="none";
photoView.style.display="block";
noteField.value=albums[name].note;
renderPhotos();
}

function goBack(){
photoView.style.display="none";
albumView.style.display="block";
pageTitle.textContent="Álbumes";
renderAlbums();
}

function renderPhotos(){
gallery.innerHTML="";
albums[currentAlbum].photos.forEach((src,i)=>{
const div=document.createElement("div");
div.className="photo";

const img=document.createElement("img");
img.src=src;
img.onclick=()=>{
document.getElementById("lightbox").style.display="flex";
document.getElementById("lightboxImg").src=src;
};

const btn=document.createElement("button");
btn.className="delete-btn";
btn.textContent="✕";
btn.onclick=()=>{
albums[currentAlbum].photos.splice(i,1);
saveAlbums();
renderPhotos();
};

div.appendChild(img);
div.appendChild(btn);
gallery.appendChild(div);
});
}

document.getElementById("photoInput").addEventListener("change",function(e){
[...e.target.files].forEach(file=>{
const reader=new FileReader();
reader.onload=(ev)=>{
albums[currentAlbum].photos.push(ev.target.result);
saveAlbums();
renderPhotos();
};
reader.readAsDataURL(file);
});
this.value="";
});

noteField.addEventListener("input",()=>{
albums[currentAlbum].note=noteField.value;
saveAlbums();
});

document.getElementById("lightbox").onclick=function(){
this.style.display="none";
};

renderAlbums();
/* ===== MÚSICA GLOBAL COMPATIBLE MÓVIL ===== */
const music = document.getElementById("globalMusic");

/* Restaurar tiempo guardado */
window.addEventListener("load", () => {
    const savedTime = localStorage.getItem("musicTime");
    if (savedTime) {
        music.currentTime = parseFloat(savedTime);
    }
    attemptAutoplay();
});

/* Intentar autoplay */
function attemptAutoplay() {
    const playPromise = music.play();
    if (playPromise !== undefined) {
        playPromise
            .then(() => {
                // Autoplay funcionó
            })
            .catch(() => {
                // Si el navegador bloquea, esperar primer toque
                enableOnFirstTouch();
            });
    }
}

/* Activar en primer toque (invisible) */
function enableOnFirstTouch() {
    const startMusic = () => {
        music.play().catch(() => { });
        document.removeEventListener("touchstart", startMusic);
        document.removeEventListener("click", startMusic);
    };

    document.addEventListener("touchstart", startMusic, { once: true });
    document.addEventListener("click", startMusic, { once: true });
}

/* Guardar tiempo constantemente */
setInterval(() => {
    if (!music.paused) {
        localStorage.setItem("musicTime", music.currentTime);
    }
}, 1000);

/* Si vuelve a la pestaña, reintentar */
document.addEventListener("visibilitychange", () => {
    if (document.visibilityState === "visible" && music.paused) {
        music.play().catch(() => { });
    }
});
</script>

</body>
</html>
